"0","## Read in data "
"0","library(here)"
"0","library(rio)"
"0",""
"0","df1 <- import(here(""data/corp_76to20_bystate_MGyearrecoded.xlsx""))"
"0","df2 <- import(here(""data/suspensions_72to21_bystate_MGyearrecoded.xlsx""))"
"0","df3 <- import(here(""data/treatment dataset_2year.xlsx""))"
"0",""
"0",""
"0","# YEAR ranges from 1972-2020"
"0",""
"0","df_corp <- df3 %>%"
"0","  filter(YEAR > 2020) %>%"
"0","  group_by(STATE_CODE)"
"0",""
"0","library(maps)"
"0",""
"0","us_states <- map_data(""state"") "
"0",""
"0","# Convert state names to lowercase for merging"
"0","us_states$region <- tolower(us_states$region)"
"0",""
"0","### Create a lookup table for state abbreviations and full names"
"0","state_lookup <- data.frame(STATE_CODE = state.abb, region = tolower(state.name))"
"0",""
"0","### Merge df_map with full state names"
"0","df_corp <- left_join(df_corp, state_lookup, by = ""STATE_CODE"")"
"0",""
"0","## STATE_CODE has 51 states DC is counted as a state, but shows up as NA ## in region"
"0",""
"0","## recoded region's NAs to be DC, dc"
"0","# unique(df_corp$STATE_CODE)"
"0","# unique(df_corp$region)"
"0","df_corp$region <- if_else(is.na(df_corp$region), ""dc"", df_corp$region)"
"0",""
"0","# unique(us_states$region)"
"0","  "
"0","## Merge with map data"
"0","us_states <- left_join(us_states, df_corp, by = ""region"")"
"0",""
"0",""
"0","color_palette <- list(yellow = ""#e5de54"", # not adopted "
"0","                   dark_gray = ""#808c73"") # adopted"
"0","map_color_palette <- c(""0"" = color_palette$yellow, ""1"" = color_palette$dark_gray)"
"0",""
"0",""
"0","ggplot() +"
"0","  geom_polygon("
"0","    data = us_states,"
"0","    aes(x = long, y = lat, group = group, fill = as.factor(DD)),"
"0","    color = ""white"", size = 0.3  # Add white borders for better distinction"
"0","  ) +"
"0","  scale_fill_manual("
"0","    values = map_color_palette,"
"0","    labels = c(""Not Adopted"", ""Adopted"")"
"0","  ) +"
"0","  theme_minimal() +"
"0","  labs("
"0","    title = ""Corporal Punishment Ban Adoption by State"","
"0","    subtitle = ""States that adopted bans starting in 2020"","
"0","    fill = ""Ban Status"""
"0","  ) +"
"0","  theme("
"0","    axis.text = element_blank(),"
"0","    axis.ticks = element_blank(),"
"0","    panel.grid = element_blank()"
"0","  )"
"0",""
