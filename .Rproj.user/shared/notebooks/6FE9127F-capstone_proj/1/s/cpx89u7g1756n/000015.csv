"0","library(plotly)"
"0","library(dplyr)"
"0",""
"0","# # Ensure Race is a factor"
"0","# long_data$Race <- as.factor(long_data$Race)"
"0","# "
"0","# # Calculate smoothed values using LOESS"
"0","# smoothed_data <- long_data %>%"
"0","#   group_by(Race) %>%"
"0","#   mutate(Smoothed = predict(loess(SuspensionRate ~ YEAR, span = 0.3)))"
"0",""
"0","# Define custom colors for each race category"
"0","custom_colors <- c("
"0","  ""AI"" = brand_colors$light_gray, "
"0","  ""BL"" = brand_colors$sage, "
"0","  ""WH"" = brand_colors$dark_gray"
"0",")"
"0",""
"0","# Create the Plotly interactive plot"
"0","fig <- plot_ly("
"0","  data = long_data, "
"0","  x = ~YEAR, "
"0","  y = ~SuspensionRate, "
"0","  color = ~Race, "
"0","  colors = custom_colors,  # Assign custom colors"
"0","  type = 'scatter', "
"0","  mode = 'lines',"
"0","  showlegend = TRUE,"
"0","  name = ~Race"
"0",") %>% "
"0","  add_trace("
"0","    data = smoothed_data, "
"0","    x = ~YEAR, "
"0","    y = ~Smoothed, "
"0","    color = ~Race, "
"0","    colors = custom_colors,  # Assign same colors to smoothed lines"
"0","    type = 'scatter', "
"0","    mode = 'lines',"
"0","    showlegend = FALSE  # Hide duplicate legend entries"
"0","  ) %>% "
"0","  layout("
"0","    title = ""Out of School Suspension Rates over 50 Years by Race"","
"0","    xaxis = list(title = ""Year""),"
"0","    yaxis = list(title = ""Suspension Rates (%)""),"
"0","    legend = list(title = list(text = ""Race""))"
"0","  )"
"0",""
"0","fig  # Display the plot"
